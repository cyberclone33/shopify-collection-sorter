{% comment %}
  Premium Pet Products Carousel by Alpha Dog
  An elegant, high-end carousel display for your premium pet products
{% endcomment %}

<!-- No external CSS needed for simple scroll slider -->

<div id="alpha-dog-carousel" class="alpha-dog-carousel">
  <div class="carousel-container">
    <style>
      /* Premium Pet Products Carousel */
      .alpha-dog-carousel {
        margin: 40px 0;
        overflow: hidden;
        position: relative;
        padding: 10px 5px 30px;
        max-width: 100%;
      }
      
      /* Elegant Header styling */
      .carousel-header {
        text-align: center;
        margin-bottom: 35px;
        position: relative;
        z-index: 2;
      }
      
      .carousel-header h2 {
        color: {{ block.settings.heading_color }};
        font-size: 28px;
        margin-bottom: 12px;
        font-weight: 600;
        letter-spacing: 0.02em;
        position: relative;
        display: inline-block;
      }
      
      .carousel-header h2::after {
        content: '';
        position: absolute;
        bottom: -8px;
        left: 50%;
        transform: translateX(-50%);
        width: 50px;
        height: 2px;
        background-color: {{ block.settings.heading_color }};
      }
      
      .carousel-header p {
        color: {{ block.settings.subtitle_color }};
        font-size: 15px;
        max-width: 700px;
        margin: 0 auto;
        line-height: 1.5;
        font-weight: 300;
      }
      
      /* Premium product card design */
      .product-card, 
      .alpha-dog-product-card {
        position: relative;
        width: 100%;
        height: 100%;
        min-height: {{ block.settings.card_height }}px;
        background-color: {{ block.settings.card_bg_color }};
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
        cursor: pointer;
        display: flex;
        flex-direction: column;
        border: 1px solid rgba(240, 240, 240, 0.8);
      }
      
      /* Product image container */
      .product-image-container {
        width: 100%;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: {{ block.settings.image_bg_color }};
        flex-grow: 0;
        flex-shrink: 0;
        margin: 0;
        border-radius: 8px 8px 0 0;
      }
      
      .product-card:hover,
      .alpha-dog-product-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
        border-color: rgba(220, 220, 220, 0.8);
      }
      
      .product-card:active,
      .alpha-dog-product-card:active {
        transform: translateY(-2px);
        transition: all 0.2s;
      }
      
      .product-image {
        width: 100%;
        height: {{ block.settings.image_height }}px;
        position: relative;
        overflow: hidden;
        background-color: {{ block.settings.image_bg_color }};
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
        transition: all 0.4s ease;
      }
      
      /* Removed red line behind product image */
      
      .product-image img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        display: block;
        transition: transform 0.7s cubic-bezier(0.22, 1, 0.36, 1);
      }
      
      .product-card:hover .product-image img {
        transform: scale(1.08);
      }
      
      /* Elegant hover overlay */
      .product-image::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.02);
        opacity: 0;
        transition: opacity 0.5s ease;
      }
      
      .product-card:hover .product-image::after {
        opacity: 1;
      }
      
      /* Premium info section with soft gradient */
      .product-info {
        position: relative;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 18px 18px 60px; /* Increased padding at bottom to make room for button */
        background: white;
        color: #333;
        z-index: 1;
        overflow: visible; /* Changed to visible to ensure button shows */
        border-top: 1px solid rgba(240, 240, 240, 0.8);
        transition: all 0.3s ease;
      }
      
      .product-card:hover .product-info {
        background: linear-gradient(to bottom, #ffffff, #f9f9f9);
      }
      
      .product-title {
        font-size: 15px;
        font-weight: 500;
        margin-bottom: 6px;
        color: #333333;
        display: -webkit-box;
        -webkit-line-clamp: 1;
        -webkit-box-orient: vertical;
        overflow: hidden;
        letter-spacing: 0.01em;
      }
      
      /* Premium price display */
      .price-container {
        display: flex;
        align-items: baseline;
        margin-top: 6px;
        flex-wrap: wrap;
      }
      
      .current-price {
        font-weight: 600;
        color: {{ block.settings.badge_bg_color }};
        font-size: 16px;
        margin-right: 10px;
        letter-spacing: 0;
      }
      
      .original-price {
        text-decoration: line-through;
        color: #999;
        font-size: 13px;
        font-weight: 400;
      }
      
      /* Description text */
      .product-bio {
        font-size: 13px;
        color: #777;
        margin: 8px 0 6px;
        line-height: 1.4;
        max-height: 36px;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 1;
        -webkit-box-orient: vertical;
      }
      
      /* Remove Tinder-style action buttons */
      
      /* Premium savings badge */
      .savings-badge {
        position: absolute;
        top: 12px;
        right: 12px;
        z-index: 10;
        background-color: {{ block.settings.badge_bg_color }};
        color: white;
        padding: 5px 12px;
        font-size: 11px;
        font-weight: 500;
        border-radius: 4px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        letter-spacing: 0.5px;
        text-transform: uppercase;
      }
      
      /* Elegant sale label */
      .photo-indicator {
        position: absolute;
        top: 12px;
        left: 12px;
        z-index: 10;
        background-color: rgba(255, 255, 255, 0.9);
        color: #333;
        padding: 5px 12px;
        font-size: 10px;
        font-weight: 600;
        border-radius: 4px;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
      }
      
      /* Elegant slide transitions */
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      /* Removed all class-based button styles in favor of inline styles */
      
      .add-to-cart:hover {
        background-color: {{ block.settings.badge_bg_color }};
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      }
      
      /* Enhanced add to cart button position & style */
      .add-to-cart {
        position: relative;
        bottom: auto;
        left: auto;
        right: auto;
        padding: 8px 12px;
        color: white;
        background-color: {{ block.settings.button_bg_color }};
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: 500;
        font-size: 12px;
        transition: all 0.3s ease;
        z-index: 3;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin: 8px 0 10px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }
      
      /* Override any theme styling that adds "Shop now to" text */
      .alpha-dog-carousel .product-card::before,
      .alpha-dog-carousel .product-card::after,
      .alpha-dog-carousel .add-to-cart::before,
      .alpha-dog-product-card::before,
      .alpha-dog-product-card::after,
      .alpha-dog-product-card .add-to-cart::before {
        content: none !important;
        display: none !important;
      }
      
      /* Additional overrides to prevent theme interference */
      .alpha-dog-carousel .add-to-cart,
      .alpha-dog-product-card .add-to-cart {
        margin-left: 0 !important;
        margin-right: 0 !important;
        width: auto !important;
        text-align: center !important;
      }
      
      /* Extra specificity for the .alpha-dog-product-card */
      .alpha-dog-product-card {
        position: relative !important;
        overflow: hidden !important;
      }
      
      /* Enhanced button styling with !important to override theme styles */
      .alpha-dog-product-card .add-to-cart {
        position: absolute !important;
        bottom: 10px !important;
        left: 10px !important;
        color: {{ block.settings.button_text_color }} !important;
        background-color: {{ block.settings.button_bg_color }} !important;
        text-decoration: none !important;
      }
      
      /* Make sure there's no "Shop now" text before the button */
      .alpha-dog-product-card .add-to-cart::before,
      .alpha-dog-product-card .add-to-cart::after {
        content: none !important;
        display: none !important;
      }
      
      /* We can't use :contains() as it's not widely supported */
      
      /* Hide any element with class names that might contain "shop-now" */
      .alpha-dog-product-card [class*="shop-now"],
      .alpha-dog-product-card [class*="shopnow"],
      .alpha-dog-product-card .shop-now-text,
      .alpha-dog-product-card .shop-text,
      .alpha-dog-product-card .product-shop-now {
        display: none !important;
      }
      
      /* Override the second hover style to match the first one */
      
      .add-to-cart:active {
        transform: translateY(0);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      
      /* Simple horizontal scroll carousel styling */
      .alpha-dog-carousel {
        margin: 40px 0;
        background-color: transparent;
        padding: 10px 0 30px;
        position: relative;
        -webkit-overflow-scrolling: touch;
      }
      
      .products-scroll {
        width: 100%;
        overflow-x: auto;
        overflow-y: hidden;
        white-space: nowrap;
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE and Edge */
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        padding: 10px 0 25px;
      }
      
      .products-scroll::-webkit-scrollbar {
        display: none; /* Chrome, Safari and Opera */
      }
      
      .product-slide {
        display: inline-block;
        vertical-align: top;
        white-space: normal;
        height: auto;
        width: 280px;
        padding: 4px;
        margin-right: 10px;
        scroll-snap-align: start;
      }
      
      @media (hover: hover) {
        .product-slide:hover .product-card {
          box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
        }
      }
      
      /* Add slight padding to carousel container */
      .carousel-container {
        padding: 0 5px;
      }
      
      /* Responsive adjustments for simple horizontal slider */
      @media (max-width: 767px) {
        .product-slide {
          width: 240px;
        }
        .product-card {
          min-height: 300px;
        }
        .product-image {
          height: 160px;
        }
      }
      
      @media (max-width: 480px) {
        .alpha-dog-carousel {
          padding: 5px;
        }
        .product-slide {
          padding: 4px;
          width: 180px;
          margin-right: 8px;
        }
        .product-card {
          min-height: 280px;
          border-radius: 6px;
        }
        .product-image-container {
          height: 160px !important;
        }
        .product-info {
          padding: 8px;
        }
        .product-title {
          font-size: 12px;
          -webkit-line-clamp: 1;
          margin-bottom: 2px;
        }
        .current-price {
          font-size: 11px;
          margin-right: 4px;
        }
        .original-price {
          font-size: 10px;
        }
        .product-bio {
          font-size: 10px;
          margin: 4px 0;
        }
        .photo-indicator, .savings-badge {
          font-size: 9px;
          padding: 2px 4px;
        }
      }
      
      /* Pagination and navigation styles removed */
      /* Custom scrollbar */
      .custom-scrollbar::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      
      .custom-scrollbar::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }
      
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #cccccc;
        border-radius: 10px;
      }
      
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: {{ block.settings.pagination_active_color }};
      }
      
      /* Additional features */
      .product-rating {
        display: flex;
        align-items: center;
        margin-top: 8px;
      }
      
      .rating-stars {
        display: flex;
        color: #ffcc00;
        margin-right: 5px;
      }
      
      .availability {
        color: #22c55e;
        font-size: 12px;
        margin-top: 5px;
        font-weight: 500;
      }
      
      .product-meta {
        display: flex;
        margin-top: 8px;
        font-size: 12px;
        opacity: 0.8;
      }
      
      .product-meta span {
        margin-right: 15px;
      }
      
      /* Quick view features */
      .quick-view {
        opacity: 0;
        position: absolute;
        left: 0;
        right: 0;
        top: 50%;
        text-align: center;
        transform: translateY(-50%);
        transition: opacity 0.3s ease;
        pointer-events: none;
        z-index: 2;
      }
      
      .quick-view-btn {
        background: {{ block.settings.button_bg_color }};
        color: {{ block.settings.button_text_color }};
        border: none;
        padding: 8px 15px;
        font-weight: 600;
        border-radius: 4px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        pointer-events: auto;
      }
      
      .product-card:hover .quick-view {
        opacity: 1;
      }
      
      /* Responsive design */
      @media screen and (max-width: 767px) {
        .swiper-button-next,
        .swiper-button-prev {
          display: flex;
        }
        
        .product-title {
          font-size: 16px;
        }
        
        .current-price {
          font-size: 14px;
        }
      }
      
      /* Debug styling */
      .debug-info {
        margin-top: 20px;
        padding: 15px;
        background-color: #f5f5f5;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 12px;
        display: none;
      }
      
      {% if block.settings.show_debug %}
      .debug-info {
        display: block;
      }
      {% endif %}
    </style>

    <div class="carousel-header">
      <h2>{{ block.settings.heading_text }}</h2>
      <p>{{ block.settings.subtitle_text }}</p>
    </div>

    <!-- Simple Horizontal Scroll Container -->
    <div class="products-scroll">
        {% assign custom_tag = block.settings.product_tag | default: 'DailyDiscount_每日優惠' %}
        {% assign max_products = block.settings.max_products | default: 12 %}
        {% assign counter = 0 %}
        {% assign total_products = 0 %}
        {% assign discounted_products = 0 %}
        
        {% comment %} 
          Approach 1: Try to use a collection with the tag name if it exists 
        {% endcomment %}
        {% assign tag_handle = custom_tag | handleize %}
        {% if collections[tag_handle] != blank and collections[tag_handle].products.size > 0 %}
          {% assign products_to_check = collections[tag_handle].products %}
        {% else %}
          {% comment %} 
            Approach 2: Use all products and check tags manually 
          {% endcomment %}
          {% assign products_to_check = collections.all.products %}
        {% endif %}
        
        {% assign total_products = products_to_check.size %}
        
        {% comment %} Display all products for comparison in debug mode {% endcomment %}
        {% if block.settings.show_debug %}
          <div class="debug-info">
            <p><strong>Using all products for display (debug mode)</strong></p>
          </div>
        {% endif %}
        
        {% for product in products_to_check %}
          {% assign should_display = false %}
          
          {% comment %} Check if product has the required tag {% endcomment %}
          {% if block.settings.show_all_products %}
            {% assign should_display = true %}
          {% else %}
            {% for tag in product.tags %}
              {% if tag == custom_tag %}
                {% assign should_display = true %}
                {% break %}
              {% endif %}
            {% endfor %}
          {% endif %}
          
          {% if should_display or block.settings.show_all_products %}
            {% if counter < max_products %}
              {% assign current_variant = product.selected_or_first_available_variant %}
              {% if current_variant.compare_at_price > current_variant.price or block.settings.show_non_discounted %}
                {% assign discounted_products = discounted_products | plus: 1 %}
                {% assign savings_amount = current_variant.compare_at_price | minus: current_variant.price %}
                {% assign savings_percentage = savings_amount | times: 100 | divided_by: current_variant.compare_at_price | round | at_least: 1 %}
                
                <div class="product-slide">
                  <div class="product-card" style="position: relative; background: white; border-radius: 8px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); overflow: hidden; height: 100%; display: flex; flex-direction: column;">
                    <!-- Product Image Section -->
                    <a href="{{ product.url }}" style="text-decoration: none; display: block;">
                      <div class="product-image-container" style="height: {{ block.settings.image_height }}px; padding: 0;">
                        {% if product.featured_image %}
                          <img src="{{ product.featured_image | image_url: width: 400 }}" 
                               alt="{{ product.title }}" 
                               style="width: 100%; height: 100%; object-fit: cover; max-width: 100%;" 
                               loading="lazy"
                               width="400" 
                               height="{{ block.settings.image_height }}">
                        {% else %}
                          <img src="{{ 'placeholder-image.jpg' | asset_url }}" 
                               alt="{{ product.title }}" 
                               style="width: 100%; height: 100%; object-fit: cover; max-width: 100%;" 
                               loading="lazy"
                               width="400" 
                               height="{{ block.settings.image_height }}">
                        {% endif %}
                        
                        <!-- Sale badge -->
                        <div style="position: absolute; top: 8px; left: 8px; background-color: rgba(0,0,0,0.7); color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; font-weight: 500; text-transform: uppercase; z-index: 5;">SALE</div>
                        
                        {% if current_variant.compare_at_price > current_variant.price %}
                          <div style="position: absolute; top: 8px; right: 8px; background-color: {{ block.settings.badge_bg_color }}; color: white; padding: 4px 8px; font-size: 11px; border-radius: 4px; font-weight: 500; z-index: 5;">{{ savings_percentage }}% OFF</div>
                        {% endif %}
                      </div>
                      
                      <!-- Product Info Section -->
                      <div style="padding: 12px 12px 60px; border-top: 1px solid #f0f0f0;">
                        <div style="font-size: 15px; font-weight: 500; margin-bottom: 6px; color: #333; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ product.title }}</div>
                        
                        {% if current_variant.title != 'Default Title' %}
                        <div style="font-size: 12px; color: #666; margin-bottom: 6px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                          Variant: {{ current_variant.title }}
                        </div>
                        {% endif %}
                        
                        <div style="display: flex; align-items: baseline; margin-top: 4px;">
                          <div style="font-weight: 600; color: {{ block.settings.badge_bg_color }}; font-size: 16px; margin-right: 8px;">{{ current_variant.price | money }}</div>
                          {% if current_variant.compare_at_price > current_variant.price %}
                            <div style="text-decoration: line-through; color: #999; font-size: 13px;">{{ current_variant.compare_at_price | money }}</div>
                          {% endif %}
                        </div>
                      </div>
                    </a>
                    
                    <!-- Add to Cart Button - Always Visible -->
                    <div style="position: absolute; bottom: 15px; left: 15px; width: calc(100% - 30px); z-index: 100;">
                      <button 
                          onclick="addToCart('{{ current_variant.id }}')" 
                          {% unless current_variant.available %}disabled{% endunless %}
                          style="width: 100%; 
                                 padding: 10px 0; 
                                 background-color: {{ block.settings.button_bg_color }}; 
                                 color: white; 
                                 border: none; 
                                 border-radius: 4px; 
                                 font-weight: 500; 
                                 font-size: 12px; 
                                 text-transform: uppercase; 
                                 cursor: pointer;
                                 display: block !important;
                                 opacity: 1 !important;
                                 visibility: visible !important;">
                        {% if current_variant.available %}
                          ADD TO CART
                        {% else %}
                          SOLD OUT
                        {% endif %}
                      </button>
                    </div>
                  </div>
                </div>
                {% assign counter = counter | plus: 1 %}
              {% endif %}
            {% endif %}
          {% endif %}
        {% endfor %}
    </div>
    
    {% if counter == 0 %}
      <p style="text-align: center; margin: 50px 0; color: #666;">
        No discounted products available with the selected tag.
      </p>
    {% endif %}
    
    {% if block.settings.show_debug %}
    <div class="debug-info custom-scrollbar">
      <h4>Debug Information</h4>
      <p>Looking for tag: "{{ custom_tag }}"</p>
      <p>Tag handle: "{{ tag_handle }}"</p>
      <p>Collection with tag exists: {% if collections[tag_handle] != blank %}Yes{% else %}No{% endif %}</p>
      <p>Total products checked: {{ total_products }}</p>
      <p>Products with discounts: {{ discounted_products }}</p>
      <p>Products displayed: {{ counter }}</p>
      
      <h4>All Available Tags</h4>
      <div style="display: flex; flex-wrap: wrap; gap: 8px; max-height: 150px; overflow-y: auto;" class="custom-scrollbar">
        {% assign all_tags = collections.all.products | map: 'tags' | join: ',' | split: ',' | uniq | sort %}
        {% for tag in all_tags %}
          <div style="background: #eee; padding: 5px 10px; border-radius: 4px; margin-bottom: 4px;">{{ tag }}</div>
        {% endfor %}
      </div>

      <h4>Search Options</h4>
      <p>Try using the tags exactly as shown above. You can also try the following approaches:</p>
      <ol>
        <li>Change the tag to use an exact tag from the list above</li>
        <li>Create a collection with the same name as your tag</li>
        <li>Check "Show All Discounted Products" to see all available discounted products</li>
      </ol>
      
      <h4>Test Products</h4>
      <div style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; margin-top: 10px;" class="custom-scrollbar">
        <p><strong>First 10 products and their tags:</strong></p>
        {% for product in collections.all.products limit: 10 %}
          <div style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee;">
            <strong>{{ product.title }}</strong><br>
            Tags: 
            {% if product.tags.size > 0 %}
              {% for tag in product.tags %}
                <span style="background: #f5f5f5; padding: 2px 6px; margin-right: 4px; border-radius: 3px; font-size: 11px;">{{ tag }}</span>
              {% endfor %}
            {% else %}
              <em>No tags</em>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
  
  <!-- Simple "Add to cart" functionality -->
  <script>
    // Function to add product to cart
    function addToCart(variantId) {
      // Change button text to indicate loading
      const button = event.target;
      const originalText = button.textContent;
      button.textContent = 'ADDING...';
      button.disabled = true;
      
      // Add to cart using Shopify AJAX API
      fetch('/cart/add.js', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        },
        body: JSON.stringify({
          id: variantId,
          quantity: 1
        })
      })
      .then(response => response.json())
      .then(data => {
        // Success - update the cart count and notify the user
        button.textContent = 'ADDED!';
        setTimeout(() => {
          button.textContent = originalText;
          button.disabled = false;
        }, 2000);
        
        // Refresh cart drawer/count if applicable
        if (typeof window.refreshCart === 'function') {
          window.refreshCart();
        }
      })
      .catch(error => {
        // Error handling
        console.error('Error adding product to cart:', error);
        button.textContent = 'ERROR';
        setTimeout(() => {
          button.textContent = originalText;
          button.disabled = false;
        }, 2000);
      });
    }
    
    {% if block.settings.autoplay %}
    // Simple auto-scroll functionality for autoplay
    document.addEventListener('DOMContentLoaded', function() {
      const productsScroll = document.querySelector('.products-scroll');
      if (productsScroll) {
        let scrollAmount = 0;
        const scrollStep = 1;
        const scrollDelay = 30;
        const scrollPause = {{ block.settings.autoplay_delay }};
        
        let scrollTimer = null;
        let pauseTimer = null;
        
        function startScrolling() {
          if (scrollTimer) return;
          
          scrollTimer = setInterval(function() {
            productsScroll.scrollLeft += scrollStep;
            scrollAmount += scrollStep;
            
            if (scrollAmount >= productsScroll.scrollWidth - productsScroll.clientWidth) {
              clearInterval(scrollTimer);
              scrollTimer = null;
              scrollAmount = 0;
              
              // Pause at the end
              clearTimeout(pauseTimer);
              pauseTimer = setTimeout(function() {
                productsScroll.scrollLeft = 0;
                startScrolling();
              }, scrollPause);
            }
          }, scrollDelay);
        }
        
        // Pause scrolling when mouse is over the carousel
        productsScroll.addEventListener('mouseenter', function() {
          clearInterval(scrollTimer);
          scrollTimer = null;
          clearTimeout(pauseTimer);
        });
        
        // Resume scrolling when mouse leaves
        productsScroll.addEventListener('mouseleave', function() {
          startScrolling();
        });
        
        // Start scrolling after a delay
        setTimeout(startScrolling, scrollPause);
      }
    });
    {% endif %}
  </script>
</div>

{% schema %}
{
  "name": "Product Carousel",
  "target": "section",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "product_tag",
      "label": "Product Tag",
      "default": "DailyDiscount_每日優惠"
    },
    {
      "type": "text",
      "id": "heading_text",
      "label": "Heading",
      "default": "Exclusive Deals & Offers"
    },
    {
      "type": "text",
      "id": "subtitle_text",
      "label": "Subtitle",
      "default": "Discover our curated selection of premium products"
    },
    {
      "type": "range",
      "id": "max_products",
      "min": 1,
      "max": 24,
      "step": 1,
      "label": "Max Products",
      "default": 12
    },
    {
      "type": "header",
      "content": "Design"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Subtitle Color",
      "default": "#666666"
    },
    {
      "type": "color",
      "id": "card_bg_color",
      "label": "Card Background",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "card_height",
      "min": 280,
      "max": 500,
      "step": 10,
      "label": "Card Height",
      "default": 380
    },
    {
      "type": "range",
      "id": "image_height",
      "min": 150,
      "max": 350,
      "step": 10,
      "label": "Image Height",
      "default": 260
    },
    {
      "type": "select",
      "id": "card_shadow",
      "label": "Card Shadow",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "0 2px 5px rgba(0, 0, 0, 0.05)",
          "label": "Light"
        },
        {
          "value": "0 3px 10px rgba(0, 0, 0, 0.08)",
          "label": "Medium"
        },
        {
          "value": "0 5px 15px rgba(0, 0, 0, 0.12)",
          "label": "Bold"
        }
      ],
      "default": "0 3px 10px rgba(0, 0, 0, 0.08)"
    },
    {
      "type": "color",
      "id": "badge_bg_color",
      "label": "Sale Badge Color",
      "default": "#FF385C"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "select",
      "id": "overlay_gradient_style",
      "label": "Overlay Style",
      "options": [
        {
          "value": "gradient",
          "label": "Gradient"
        },
        {
          "value": "solid",
          "label": "Solid"
        },
        {
          "value": "none",
          "label": "None"
        }
      ],
      "default": "gradient"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay Color",
      "default": "rgba(0,0,0,0.7)"
    },
    {
      "type": "checkbox",
      "id": "badge_round",
      "label": "Rounded Badges",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_pagination",
      "label": "Show Pagination",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "label": "Show Navigation",
      "default": true
    }, 
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Enable Autoplay",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "loop",
      "label": "Infinite Loop",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_all_products",
      "label": "Show All Discounted",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "navigation_round",
      "label": "Round Navigation",
      "default": true
    },
    {
      "type": "range",
      "id": "autoplay_delay",
      "min": 1000,
      "max": 9000,
      "step": 1000,
      "label": "Autoplay Delay",
      "default": 3000
    }
  ]
}
{% endschema %}